{"id":"M0a0","dependencies":[{"name":"/Users/tim/Dropbox/Server/htdocs/sandbox/kirby-nightly/site/plugins/kirby-builder/.babelrc","includedInParent":true,"mtime":1537474488486},{"name":"/Users/tim/Dropbox/Server/htdocs/sandbox/kirby-nightly/site/plugins/kirby-builder/package.json","includedInParent":true,"mtime":1543244669900},{"name":"./BuilderBlock.vue","loc":{"line":71,"column":25},"parent":"/Users/tim/Dropbox/Server/htdocs/sandbox/kirby-nightly/site/plugins/kirby-builder/src/components/BuilderField.vue","resolved":"/Users/tim/Dropbox/Server/htdocs/sandbox/kirby-nightly/site/plugins/kirby-builder/src/components/BuilderBlock.vue"}],"generated":{"js":"var $M0a0$exports={};function $M0a0$var$_typeof(t){return($M0a0$var$_typeof=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}$parcel$require(\"M0a0\",\"./BuilderBlock.vue\");var $M0a0$export$default={props:{value:String,fieldsets:Object,columns:Number,limit:Number,label:String,preview:Object,pageId:String,pageUid:String},components:{BuilderBlock:$M0a0$import$BuilderBlock},mounted:function(){var t=this;this.value&&(this.value.forEach(function(e,i){var n=t.fieldsets[e._key];t.blocks.push(t.newBlock(n,e._key,e,i))}),this.lastUniqueKey=this.value.length)},data:function(){return{blocks:[],toggle:!0,targetPosition:null,lastUniqueKey:0,dataField:{label:\"date label\",type:\"date\"},dateValue:null}},computed:{val:function(){return this.blocks.map(function(t){return t.content})},columnsCount:function(){return this.columns?this.columns:\"1\"},columnWidth:function(){return this.columns?\"1/\"+this.columns:\"1/1\"},draggableOptions:function(){return{group:\"kirby-builder\",put:\"kirby-builder\",clone:!0,forceFallback:!0,handle:\".kBuilder__dragDropHandle\",scroll:!0}},blockCount:function(){return this.blocks.length},fieldsetCount:function(){return Object.keys(this.fieldsets).length},fieldsetKeys:function(){return Object.keys(this.fieldsets)},addBlockButtonLabel:function(){return 1==this.fieldsetCount?\"\".concat(this.$t(\"add\"),\" \").concat(this.fieldsets[Object.keys(this.fieldsets)[0]].label):this.$t(\"add\")},supportedBlockTypes:function(){return Object.keys(this.fieldsets)}},methods:{onBlockInput:function(t){this.$emit(\"input\",this.val)},onBlockMoved:function(t){this.$emit(\"input\",this.val)},onBlockAdded:function(t){this.$emit(\"input\",this.val)},onBlockRemoved:function(t){this.$emit(\"input\",this.val)},onMove:function(t){var e=t.relatedContext.index!=this.blocks.length+1,i=0==this.blocks.length,n=this.supportedBlockTypes.includes(t.relatedContext.element.blockKey);return(i||e)&&n},onClickAddBlock:function(t){this.targetPosition=t,1==this.fieldsetCount?this.addBlock(this.fieldsetKeys[0]):this.$refs.dialog.open()},addBlock:function(t){var e=null==this.targetPosition?this.blocks.length:this.targetPosition,i=this.fieldsets[t],n=this.newBlock(i,t,this.getBlankContent(t,i),this.lastUniqueKey++);n.isNew=!0,this.blocks.splice(e,0,JSON.parse(JSON.stringify(n))),this.$refs.dialog.close(),this.targetPosition=null,this.$emit(\"input\",this.val)},getBlankContent:function(t,e){var i={_key:t};if(e.fields)Object.keys(e.fields).forEach(function(t){i[t]=e.fields[t].value||e.fields[t].default||\"\"});else if(e.tabs)for(var n in e.tabs)e.tabs.hasOwnProperty(n)&&function(){var t=e.tabs[n];Object.keys(t.fields).forEach(function(e){i[e]=t.fields[e].value||t.fields[e].default||\"\"})}();return i},cloneBlock:function(t){var e=JSON.parse(JSON.stringify(this.blocks[t]));e.isNew=!0,this.deepRemoveProperty(e.content,\"_uid\"),this.blocks.splice(t+1,0,e),this.blocks[t+1].uniqueKey=this.lastUniqueKey++,this.$emit(\"input\",this.val)},deleteBlock:function(t){this.clearLocalUiStates(this.blocks[t]),this.blocks.splice(t,1),this.$emit(\"input\",this.val)},deepRemoveProperty:function(t,e){var i=this;Object.keys(t).forEach(function(n){n===e?delete t[n]:\"object\"===$M0a0$var$_typeof(t[n])&&i.deepRemoveProperty(t[n],e)})},clearLocalUiStates:function(t){for(var e in t)if(t.hasOwnProperty(e)){t[e];\"_uid\"===e?localStorage.removeItem(\"kBuilder.uiState.\".concat(t[e])):\"object\"===$M0a0$var$_typeof(t[e])&&this.clearLocalUiStates(t[e])}},newBlock:function(t,e,i,n){return{fields:t.fields?t.fields:null,tabs:t.tabs?t.tabs:null,blockKey:e,content:i,label:t.label,uniqueKey:n,preview:t.preview,showPreview:!1}}}};$M0a0$exports.default=$M0a0$export$default;\n      if (typeof $M0a0$export$default === 'function') {\n        $M0a0$export$default = $M0a0$export$default.options;\n      }\n    \n        /* template */\n        Object.assign($M0a0$export$default, (function () {\n          var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('k-field',{staticClass:\"kBuilder\",class:'kBuilder--col-' + _vm.columnsCount,attrs:{\"label\":_vm.label}},[_c('k-draggable',{staticClass:\"kBuilder__blocks k-grid\",attrs:{\"move\":_vm.onMove,\"options\":_vm.draggableOptions},on:{\"end\":function($event){_vm.drag=false},\"update\":_vm.onBlockMoved,\"add\":_vm.onBlockAdded,\"remove\":_vm.onBlockRemoved},model:{value:(_vm.blocks),callback:function ($$v) {_vm.blocks=$$v},expression:\"blocks\"}},[_vm._l((_vm.blocks),function(block,index){return _c('k-column',{key:block.uniqueKey,staticClass:\"kBuilder__column\",attrs:{\"width\":_vm.columnWidth}},[_c('div',{staticClass:\"kBuilder__inlineAddButton\",class:{'kBuilder__inlineAddButton--horizontal': (_vm.columnsCount == 1), 'kBuilder__inlineAddButton--vertical': (_vm.columnsCount > 1)},on:{\"click\":function($event){_vm.onClickAddBlock(index)}}}),_vm._v(\" \"),_c('builder-block',{attrs:{\"page-id\":_vm.pageId,\"page-uid\":_vm.pageUid,\"block\":block,\"index\":index,\"columns-count\":_vm.columnsCount,\"show-preview\":block.showPreview},on:{\"update:showPreview\":function($event){_vm.$set(block, \"showPreview\", $event)},\"input\":_vm.onBlockInput,\"clone\":_vm.cloneBlock,\"delete\":_vm.deleteBlock}}),_vm._v(\" \"),((_vm.columnsCount % index == 0 && _vm.columnsCount > 1))?_c('div',{staticClass:\"kBuilder__inlineAddButton kBuilder__inlineAddButton--vertical kBuilder__inlineAddButton--after\",on:{\"click\":function($event){_vm.onClickAddBlock(index + 1)}}}):_vm._e()],1)}),_vm._v(\" \"),(!_vm.limit || _vm.blockCount < _vm.limit)?_c('k-column',{attrs:{\"width\":_vm.columnWidth}},[_c('k-button',{staticClass:\"kBuilder__addButton\",attrs:{\"icon\":\"add\"},on:{\"click\":function($event){_vm.onClickAddBlock()}}},[_vm._v(\" \"+_vm._s(_vm.addBlockButtonLabel)+\" \")])],1):_vm._e()],2),_vm._v(\" \"),_c('k-dialog',{ref:\"dialog\"},[_c('k-list',_vm._l((_vm.fieldsets),function(value,key){return _c('k-list-item',{key:key,staticClass:\"kBuilder__addBlockButton\",attrs:{\"text\":value.label},on:{\"click\":function($event){_vm.addBlock(key)}}})}))],1)],1)}\nvar staticRenderFns = []\n\n          return {\n            render: render,\n            staticRenderFns: staticRenderFns,\n            _compiled: true,\n            _scopeId: null,\n            functional: undefined\n          };\n        })());\n      ","css":".kBuilder__addButton{width:100%;background-color:transparent;padding:2.5rem .75rem;border:1px dashed #ccc;transition:background-color .3s,border-color .3s}.kBuilder__addButton:hover{background-color:#81a2be;border-color:transparent}.kBuilder__addBlockButton{cursor:pointer}.kBuilder .kBuilder--col-1{padding-left:25px}.kBuilder__dragDropHandle{width:38px;height:38px;color:#16171a;opacity:.25;z-index:1;cursor:-webkit-grab;will-change:opacity,color;transition:opacity .3s}.kBuilder__dragDropHandle--col-1{position:absolute;left:-38px;top:0;display:-ms-flexbox;display:flex;opacity:0}.kBuilder__blocks:hover .kBuilder__dragDropHandle,kBuilder__blocks:hover .kBuilder__dragDropHandle--col-1{opacity:.25}.kBuilder__block .kBuilder__dragDropHandle:hover,kBuilder__block:hover .kBuilder__dragDropHandle--col-1{opacity:1}.kBuilder__inlineAddButton{cursor:pointer;position:absolute;opacity:0;transition:opacity .3s}.kBuilder__inlineAddButton:hover{opacity:1}.kBuilder__inlineAddButton:before{content:\"\";border:0 dashed #4271ae;display:block}.kBuilder__inlineAddButton--horizontal{height:1.25rem;width:100%;bottom:100%}.kBuilder__inlineAddButton--horizontal:before{border-bottom-width:2px;padding-top:calc(.625rem - 1px)}.kBuilder__inlineAddButton--vertical{width:1.5rem;height:100%;right:100%}.kBuilder__inlineAddButton--vertical.kBuilder__inlineAddButton--after{left:100%;right:auto;top:0}.kBuilder__inlineAddButton--vertical:before{width:calc(.75rem + 1px);height:100%;border-right-width:2px}.blocklist-enter-active,.blocklist-leave-active{transition:all .5s}.blocklist-enter,.blocklist-leave-to{opacity:0;transform:translateY(-5%)}.kBuilder--col-1 .kBuilder__blocks{grid-row-gap:1.25rem}.kBuilder__column{position:relative}.kBuilder__previewFrame{width:100%;height:30px;border:none;display:block}.kBuilder__blockContent--hidden,.kBuilder__previewFrame--hidden{display:none}.sortable-ghost .kBuilder__previewFrame{pointer-events:none}"},"hash":"f5e0cea92d133a27d9e6849fcfb08407","cacheData":{"env":{},"imports":{"$M0a0$import$BuilderBlock":["./BuilderBlock.vue","default"]},"exports":{"default":"$M0a0$export$default"},"wildcards":[],"sideEffects":true,"isES6Module":true,"shouldWrap":false}}